<!DOCTYPE html>
<html dir="ltr" lang="zh-CN">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Cache-Control" content="max-age=7200" />
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <title>妈妈校园</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="logo"><img src="images/logo.png" width="170"></div>
    <div class="bd">
        <div class="shop-ok hide">
            <h3>恭喜您，已成功购买本次优惠商品</h3>
            <p>欲了解更多优惠信息，可关注<br>“妈妈校园”微信公众平台</p>
        </div>
        <div class="bd-func">
            <div class="bd-func-login hide">登录/注册</div>
            <div class="bd-func-shop">
                <div class="shop-input">商家输入优惠代码：<input type="text" id="code"></div>
                <div class="shop-btn"><button id="postCode">确认</button></div>
            </div>
        </div>
        <img src="images/product.jpg" id="productImage">
    </div>
    <div class="ft">
        <div class="arrow"></div>
        <div class="back"></div>
    </div>
    <div class="login-pop hide">
        <div class="login-bd">
            <div class="inputa">
                <div class="input-label"></div>
                <div class="input-box"><input type="phone" placeholder="请输入手机号码"></div>
            </div>
            <div class="inputb">
                <div class="decode"><input type="phone"></div>
                <div class="getcode">
                    <div class="get"><span>获取验证码</span></div>
                    <div class="reget">秒后重新获取</div>
                </div>
            </div>
            <div class="btn">
                <button>登录</button>
            </div>
        </div>
    </div>
<script src="zepto.min.js"></script>
<script>
;(function($) {
    var serial_no = GetQueryString('serial_no');
    if (!serial_no) {
        alert('产品参数错误，请重试');
        return false;
    } else {
        $.getJSON('http://zebra.easybird.cn/serials/build_serial', {serial_no: serial_no}, function(json) {
            var primg = json.product_image.product_image.url;
            $('#productImage').attr('src', primg);
        });
    }
    $('#postCode').click(function() {
        var code = $('#code').val();
        if (!code) {
            alert('请输入优惠代码');
        } else {
            $.post('http://zebra.easybird.cn/api/serials/confirm_action', {serial_no:serial_no, decode: code}, function(json) {
                var result = json.result;
                if (result) {
                    $('.shop-ok').removeClass('hide');
                } else {
                    alert('优惠代码有误');
                    $('.shop-ok').addClass('hide');
                }
            });
        }
    });
    function GetQueryString(name) {
         var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
         var r = window.location.search.substr(1).match(reg);
         if(r!=null)return  unescape(r[2]); return null;
     }
})(Zepto)
</script>
</body>
</html>
